<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ãƒã‚¤ã‚¿ãƒ«è©•ä¾¡ãƒã‚§ãƒƒã‚«ãƒ¼</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body{background:#f4f8fc;font-family:'Segoe UI',sans-serif}
    .vital-container{max-width:900px;margin:0 auto;padding:30px}
    .card-box{background:#fff;border-left:8px solid #007acc;border-radius:14px;padding:24px;margin-bottom:24px;box-shadow:0 4px 15px rgba(0,0,0,.08);transition:transform .3s ease,box-shadow .3s ease}
    .card-box:hover{transform:scale(1.01);box-shadow:0 6px 18px rgba(0,0,0,.12)}
    .card-box h3{margin-top:0;color:#007acc;font-size:1.3em;border-bottom:1px solid #e0e0e0;padding-bottom:6px}
    .result{font-weight:bold;font-size:1.15em;color:#333;padding-top:5px;white-space:pre-wrap}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1.2em}
    .form-grid label{display:block;font-weight:bold;margin-bottom:4px}
    .form-grid input,.form-grid select{width:100%;padding:.6em;border:1px solid #ccc;border-radius:6px;background:#fdfdfd;box-shadow:inset 0 1px 2px rgba(0,0,0,.05)}
    .btn{position:relative;display:inline-block;padding:14px 40px;font-size:1.05em;font-weight:bold;color:#fff;border:none;border-radius:50px;cursor:pointer;overflow:hidden;transition:transform .2s ease,box-shadow .2s ease}
    .btn::after{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:rgba(255,255,255,.25);transform:skewX(-20deg);transition:left .45s ease}
    .btn:hover{transform:scale(1.05)}
    .btn:hover::after{left:100%}
    .btn-evaluate{background:linear-gradient(135deg,#34c759 0%,#28a745 100%);box-shadow:0 8px 20px rgba(40,167,69,.35)}
    .btn-copy{background:linear-gradient(135deg,#4f9dff 0%,#007bff 100%);box-shadow:0 8px 20px rgba(0,123,255,.35)}
    .btn-wrapper{display:flex;justify-content:center;gap:20px;margin-top:32px;flex-wrap:wrap}
    .hidden{display:none}
  </style>
</head>
<body>
<section class="vital-container">
  <div class="card-box">
    <h3>ğŸ“˜ è©•ä¾¡çµæœã®è§£èª¬</h3>
    <ul>
      <li><strong>ã‚·ãƒ§ãƒƒã‚¯ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆSIï¼‰</strong>ï¼è„ˆæ‹ / åç¸®æœŸè¡€åœ§</li>
      <li><strong>è„ˆåœ§ï¼ˆPPï¼‰</strong>ï¼åç¸®æœŸè¡€åœ§ âˆ’ æ‹¡å¼µæœŸè¡€åœ§</li>
      <li><strong>è„ˆåœ§æ¯”ï¼ˆPPRï¼‰</strong>ï¼PP / åç¸®æœŸè¡€åœ§</li>
      <li><strong>GCS</strong>ï¼E+V+Mï¼ˆé¸æŠå¼ï¼‰</li>
      <li><strong>JCS</strong>ï¼æ—¥æœ¬å¼æ„è­˜ãƒ¬ãƒ™ãƒ«ï¼ˆé¸æŠå¼ï¼‰</li>
      <li><strong>NEWS</strong>ï¼æ—©æœŸè­¦æˆ’ã‚¹ã‚³ã‚¢</li>
      <li><strong>qSOFA</strong>ï¼æ•—è¡€ç—‡ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</li>
    </ul>
  </div>

  <h1>ãƒã‚¤ã‚¿ãƒ«è©•ä¾¡ãƒã‚§ãƒƒã‚«ãƒ¼</h1>
  <form id="vitalForm">
    <div class="form-grid">
      <div><label>å°¿é‡ï¼ˆml/hï¼‰</label><input type="number" id="urine" min="0"></div>
      <div><label>ä½“æ¸©ï¼ˆâ„ƒï¼‰</label><input type="number" step="0.1" id="temp"></div>
      <div><label>è„ˆæ‹æ•°ï¼ˆå›/åˆ†ï¼‰</label><input type="number" id="pulse"></div>
      <div><label>å‘¼å¸æ•°ï¼ˆå›/åˆ†ï¼‰</label><input type="number" id="rr"></div>
      <div><label>æ‹¡å¼µæœŸè¡€åœ§ï¼ˆmmHgï¼‰</label><input type="number" id="dap"></div>
      <div><label>åç¸®æœŸè¡€åœ§ï¼ˆmmHgï¼‰</label><input type="number" id="bp"></div>
      <div><label>SpOâ‚‚ï¼ˆ%ï¼‰</label><input type="number" id="spo2"></div>
      <div><label>é…¸ç´ æŠ•ä¸ã‚ã‚Šï¼Ÿ</label><select id="oxygen"><option value="no">ãªã—</option><option value="yes">ã‚ã‚Š</option></select></div>
      <!-- æ„è­˜ãƒ¬ãƒ™ãƒ«é¸æŠ -->
      <div><label>JCS</label>
        <select id="jcs"><option value="">- é¸æŠ -</option><option value="0">0: è¦šé†’</option><option value="1">1: åˆºæ¿€ãªãã¦ã‚‚è¦šé†’ã™ã‚‹ãŒåˆ†é›¢</option><option value="2">2: å‘¼åã§é–‹çœ¼</option><option value="3">3: ç—›ã¿åˆºæ¿€ã§é–‹çœ¼</option><option value="10">10: è¦šé†’ã—ã¦ã„ã‚‹ãŒè¦‹å½“è­˜éšœå®³</option><option value="20">20: å‘¼ã³ã‹ã‘ã§é–‹çœ¼ãƒ»è¦‹å½“è­˜éšœå®³</option><option value="30">30: ç—›ã¿åˆºæ¿€ã§é–‹çœ¼ãƒ»è¦‹å½“è­˜éšœå®³</option><option value="100">100: ç—›ã¿åˆºæ¿€ã§ã‚ãšã‹ã«å‹•ã</option><option value="200">200: ç—›ã¿åˆºæ¿€ã§åå°„çš„å‹•ã</option><option value="300">300: åå¿œãªã—</option></select>
      </div>
      <div><label>GCS - é–‹çœ¼ (E)</label>
        <select id="gcsE"><option value="">-</option><option value="4">E4: è‡ªç™º</option><option value="3">E3: å‘¼ã³ã‹ã‘</option><option value="2">E2: ç—›ã¿åˆºæ¿€</option><option value="1">E1: ãªã—</option></select>
      </div>
      <div><label>GCS - è¨€èª (V)</label>
        <select id="gcsV"><option value="">-</option><option value="5">V5: è¦‹å½“è­˜ã‚ã‚Š</option><option value="4">V4: æ··ä¹±</option><option value="3">V3: ä¸é©å½“</option><option value="2">V2: ç†è§£ä¸èƒ½</option><option value="1">V1: ãªã—</option></select>
      </div>
      <div><label>GCS - é‹å‹• (M)</label>
        <select id="gcsM"><option value="">-</option><option value="6">M6: å‘½ä»¤ã«å¾“ã†</option><option value="5">M5: ç—›éƒ¨å®šä½</option><option value="4">M4: é€ƒé¿</option><option value="3">M3: å±ˆæ›²</option><option value="2">M2: ä¼¸å±•</option><option value="1">M1: ãªã—</option></select>
      </div>
      <div><label>AVPU</label><select id="avpu"><option value="A">A</option><option value="V">V</option><option value="P">P</option><option value="U">U</option></select></div>
    </div>
    <div class="btn-wrapper">
      <button type="submit" class="btn btn-evaluate">è©•ä¾¡ã™ã‚‹</button>
      <button id="copyBtn" type="button" class="btn btn-copy hidden">çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
  </form>

  <div id="resultArea"></div>

<script>
const form=document.getElementById('vitalForm');
const resultArea=document.getElementById('resultArea');
const copyBtn=document.getElementById('copyBtn');
const numOrNaN=v=>v===''?NaN:Number(v);
const val=id=>numOrNaN(document.getElementById(id).value);
const card=(t,b)=>`<div class="card-box"><h3>${t}</h3><p class="result">${b}</p></div>`;

// ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
async function copyResults(){
  const text=resultArea.innerText.trim();
  if(!text){alert('ã‚³ãƒ”ãƒ¼ã™ã‚‹å†…å®¹ãŒã‚ã‚Šã¾ã›ã‚“');return;}
  try{await navigator.clipboard.writeText(text);}catch{const ta=document.createElement('textarea');ta.value=text;ta.style.opacity='0';document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);} 
  copyBtn.innerText='âœ” ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!';setTimeout(()=>copyBtn.innerText='çµæœã‚’ã‚³ãƒ”ãƒ¼',2000);
}
copyBtn.addEventListener('click',copyResults);

form.addEventListener('submit',e=>{
  e.preventDefault();
  copyBtn.classList.add('hidden');
  // å–å¾—
  const sbp=val('bp'), dbp=val('dap'), pulse=val('pulse'), rr=val('rr'), spo2=val('spo2'), temp=val('temp'), urine=val('urine');
  const oxygen=document.getElementById('oxygen').value;
  const gE=val('gcsE'), gV=val('gcsV'), gM=val('gcsM');
  const jcs=val('jcs');
  const avpu=document.getElementById('avpu').value;

  let html='';
  const add=(t,m)=>html+=card(t,m);
  const miss=l=>`è©•ä¾¡ã§ãã¾ã›ã‚“ï¼ˆ${l.join('ãƒ»')}ï¼‰`;

  // JCS & GCS
  add('ğŸ§  JCS',!isNaN(jcs)?`JCS=${jcs}`:'æœªå…¥åŠ›');
  if(!isNaN(gE)&&!isNaN(gV)&&!isNaN(gM)){
    const gcs=gE+gV+gM;
    add('ğŸ§  GCS',`${gcs}ç‚¹ (E${gE}/V${gV}/M${gM})`);
  }else{
    const m=[];if(isNaN(gE))m.push('E');if(isNaN(gV))m.push('V');if(isNaN(gM))m.push('M');add('ğŸ§  GCS',miss(m));
  }

  // SI
  if(!isNaN(pulse)&&!isNaN(sbp)&&sbp!==0){const si=(pulse/sbp).toFixed(2);add('ğŸŸ¡ SI',`SI=${si} â†’ ${si<0.5?'æ­£å¸¸':si<1?'æ³¨æ„':'ã‚·ãƒ§ãƒƒã‚¯ç–‘ã„'}`);}else{const m=[];if(isNaN(pulse))m.push('è„ˆæ‹');if(isNaN(sbp))m.push('åç¸®æœŸè¡€åœ§');add('ğŸŸ¡ SI',miss(m));}

  // PP & PPR
  if(!isNaN(sbp)&&!isNaN(dbp)){
    const pp=sbp-dbp;const ppr=(pp/sbp).toFixed(2);
    add('ğŸ“ˆ è„ˆåœ§',`${pp} mmHg â†’ ${pp<30?'ç‹­å°':pp<=60?'æ­£å¸¸':'åºƒå¹…'}`);
    add('ğŸ“‰ PPR',`PPR=${ppr} â†’ ${ppr<0.25?'ç‹­å°':ppr<=0.5?'æ­£å¸¸':'åºƒå¹…'}`);
  }else{
    const m=[];if(isNaN(sbp))m.push('åç¸®æœŸè¡€åœ§');if(isNaN(dbp))m.push('æ‹¡å¼µæœŸè¡€åœ§');add('ğŸ“ˆ è„ˆåœ§',miss(m));add('ğŸ“‰ PPR',miss(m));
  }

  // NEWS
  let news=0, used=false;
  if(!isNaN(rr)){used=true;news+=(rr<=8||rr>=25)?3:(rr>=21)?2:(rr>=9&&rr<=11)?1:0;}
  if(!isNaN(spo2)){used=true;news+=(spo2<=91)?3:(spo2<=93)?2:(spo2<=95)?1:0;}
  if(oxygen==='yes'){used=true;news+=2;}
  if(!isNaN(temp)){used=true;news+=(temp<35||temp>=39.1)?3:(temp>=38.1)?1:0;}
  if(!isNaN(sbp)){used=true;news+=(sbp<=90)?3:(sbp<=100)?2:0;}
  if(avpu!=='A'){used=true;news+=3;}
  add('ğŸ©º NEWS',used?`${news} ç‚¹`:'è©•ä¾¡ã§ãã¾ã›ã‚“ï¼ˆNEWSé–¢é€£é …ç›®ãªã—ï¼‰');

  // qSOFA
  let q=0, u=false;
  if(!isNaN(rr)){u=true;if(rr>=22)q++;}
  if(!isNaN(gE)&&!isNaN(gV)&&!isNaN(gM)){u=true;if(gE+gV+gM<15)q++;}
  if(!isNaN(sbp)){u=true;if(sbp<=100)q++;}
  add('ğŸ”´ qSOFA',u?`${q} ç‚¹`:'è©•ä¾¡ã§ãã¾ã›ã‚“ï¼ˆqSOFAé–¢é€£é …ç›®ãªã—ï¼‰');

  // DSI
  if(!isNaN(pulse)&&!isNaN(dbp)&&dbp!==0){const dsi=(pulse/dbp).toFixed(2);add('ğŸ§® DSI',`DSI=${dsi} â†’ ${dsi>=3?'å±æ©Ÿçš„':dsi>=2?'ã‚·ãƒ§ãƒƒã‚¯ç–‘ã„':dsi>=1?'è»½åº¦':'æ­£å¸¸'}`);}else{const m=[];if(isNaN(pulse))m.push('è„ˆæ‹');if(isNaN(dbp))m.push('æ‹¡å¼µæœŸè¡€åœ§');add('ğŸ§® DSI',miss(m));}

  // MAP
  if(!isNaN(sbp)&&!isNaN(dbp)){const map=((sbp+2*dbp)/3).toFixed(1);add('ğŸ©¸ MAP',`MAP=${map} mmHg`);}else{const m=[];if(isNaN(sbp))m.push('åç¸®æœŸè¡€åœ§');if(isNaN(dbp))m.push('æ‹¡å¼µæœŸè¡€åœ§');add('ğŸ©¸ MAP',miss(m));}

  // Urine
  if(!isNaN(urine)){add('ğŸš» å°¿é‡',`${urine} ml/h â†’ ${urine<50?'å°‘å°¿':'æ­£å¸¸'}`);}  

  resultArea.innerHTML=html;
  if(html){copyBtn.classList.remove('hidden');}
});
